<layout-default>
    
        <head>
	<meta http-equiv="content-type" content="text/html; charset=utf-8" />
	<title>Participant Services</title>
    </head>
    
    <body>
	<div id="wrap">
	    <h1>
            Welcome Participant!
        </h1>
		<div id="content">
			<h2 style="margin:20px">Participant Services</h2>
			<p style="margin:20px">Please select what you desire to do.</p>
			        <table style="margin:20px">
                        <tr><th>Courses I am enrolled in</th></tr>
                        <tr each={ ((recalls ('my-courses') || {}) .as_participant || {}) .enrolled_courses }><td><a href="#service/participant/my/course/#{ id }"><mark>{ name }</mark></a></td></tr>
                    </table>
                    
                    <table style="margin:20px">
                        <tr><th>Courses I have completed</th></tr>
                        <tr each={ ((recalls ('my-courses') || {}) .as_participant || {}) .completed_courses }><td><a href="#service/participant/my/course/#{ id }"><strike>{ name }</strike></a></td></tr>
                    </table>
                    
                    <table style="margin:20px">
                        <tr><th>Courses catalogue</th></tr>
                        <tr each={ (recalls ('all-courses') || {}) .courses }><td
                            ><a href="#service/participant/course/#{ id }" if={ (piece (((recalls ('my-courses') || {}) .as_participant || {}) .enrolled_courses) || {}) [id] } ><mark>{ name }</mark></a
                            ><a href="#service/participant/course/#{ id }" if={ ! (piece (((recalls ('my-courses') || {}) .as_participant || {}) .enrolled_courses) || {}) [id] && (piece (((recalls ('my-courses') || {}) .as_participant || {}) .completed_courses) || {}) [id] } ><strike>{ name }</strike></a
                            ><a href="#service/participant/course/#{ id }" if={ ! (piece (((recalls ('my-courses') || {}) .as_participant || {}) .enrolled_courses) || {}) [id] && ! (piece (((recalls ('my-courses') || {}) .as_participant || {}) .completed_courses) || {}) [id] } >{ name }</a
                        ></td></tr>
                    </table>
			
		</div>
    		<div style="clear: both;"> </div>
    	</div>
</body>
    
    
</layout-default>

<script>
(function (self) {
    self .stuff .on ('all-courses', function () {
        self .update ();
    });
    self .stuff .on ('my-courses', function () {
        self .update ();
    });
    
    var leak1 = undefined;
    var leak2 = undefined;
    
    content .courses (self);
    content .my_courses (self);
    leak1 = setInterval (self .recalls .bind (self, 'all-courses'), 300);
    leak2 = setInterval (self .recalls .bind (self, 'my-courses'), 300);
	
	display_errors ('all-courses', self);
	display_errors ('my-courses', self);
	
    self .on ('unmount', function () {
        leak1 && clearInterval (leak1);
        leak2 && clearInterval (leak2);
    });
})(this);
</script>

